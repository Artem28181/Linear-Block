<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Отзывы Linear Block</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #f0f0f0;
      max-width: 700px;
      margin: 30px auto;
      padding: 10px;
    }
    h1, h2 {
      color: #00ffaa;
      text-align: center;
    }
    .review {
      background: #222;
      margin-bottom: 15px;
      padding: 10px 15px;
      border-radius: 8px;
      box-shadow: 0 0 5px #00ffaa66;
    }
    .review-name {
      font-weight: bold;
      margin-bottom: 5px;
      font-size: 16px;
    }
    .review-text {
      white-space: pre-wrap;
      font-size: 14px;
      line-height: 1.4;
    }
    iframe {
      width: 100%;
      height: 520px;
      border: none;
      border-radius: 8px;
      margin-top: 20px;
      box-shadow: 0 0 10px #00ffaa66;
    }
  </style>
</head>
<body>

<h1>Отзывы игроков Linear Block</h1>
<div id="reviews-container">Загрузка отзывов...</div>

<h2>Оставить отзыв</h2>
<iframe 
  src="https://docs.google.com/forms/d/e/1FAIpQLSfvP2MX8awIIbbJln9v1m82NUpQge2ceUtcgJp2-T0bYs62bA/viewform?embedded=true" 
  title="Форма отзывов">
  Загрузка формы…
</iframe>

<script>
  async function loadReviews() {
    const container = document.getElementById('reviews-container');
    try {
      const res = await fetch('https://script.google.com/macros/s/AKfycbzAxgIBLFQ35XUm_eTMccxkY1O8aUqg34_MNCuKJF5iXX3DGh0GbqTOSsFdC8epLhlm0Q/exec');
      if(!res.ok) throw new Error('Ошибка загрузки');

      const data = await res.json();
      if (!Array.isArray(data) || data.length === 0) {
        container.textContent = 'Пока нет отзывов.';
        return;
      }
      container.innerHTML = '';

      data.forEach(item => {
        const div = document.createElement('div');
        div.className = 'review';

        // Подкорректируй, если в JSON поля называются иначе
        const name = item.name || item.Имя || 'Аноним';
        const comment = item.comment || item.Отзыв || '';

        div.innerHTML = `
          <div class="review-name">${sanitize(name)}</div>
          <div class="review-text">${sanitize(comment)}</div>
        `;
        container.appendChild(div);
      });
    } catch(e) {
      container.textContent = 'Ошибка загрузки отзывов: ' + e.message;
    }
  }

  // Простая защита от XSS
  function sanitize(str) {
    if(!str) return '';
    return str.replace(/[&<>"']/g, c => ({
      '&':'&amp;',
      '<':'&lt;',
      '>':'&gt;',
      '"':'&quot;',
      "'":'&#39;'
    })[c]);
  }

  window.onload = loadReviews;
</script>

</body>
</html>
